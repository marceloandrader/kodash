<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Knockout : Loading and Saving JSON data</title>
        <link href="../css/tripoli.simple.css" type="text/css" rel="stylesheet" />
        
        <link rel="stylesheet" type="text/css" href="../css/styles.css" />
        <link rel="stylesheet" type="text/css" href="../css/smallScreen.css" media="only screen and (max-device-width: 800px)" />
        <link rel="shortcut icon" href="img/favicon.ico" />
        <!--[if IE]><link rel="stylesheet" type="text/css" href="../css/tripoli.simple.ie.css" /><![endif]-->
        <!--[if lte IE 7]><link rel="stylesheet" type="text/css" href="../css/ie6ie7.css" /><![endif]-->
        <!--[if lte IE 6]><link rel="stylesheet" type="text/css" href="../css/ie6.css" /><![endif]-->
        <script type="text/javascript" src="../js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="../js/knockout-2.2.0.js"></script>
<script type="text/javascript" src="../js/cufon-yui.js"></script>
<script type="text/javascript" src="../js/titilliummaps.font.js"></script>
<script type="text/javascript" src="../js/json2.js"></script>

<!--[if lt IE 7]>
<script defer type="text/javascript" src="../js/ie6pngfix.js"></script>
<![endif]-->

<script type="text/javascript" src="../js/syntaxhighlighter_3.0.83/scripts/shCore.js"></script> 
<script type="text/javascript" src="../js/syntaxhighlighter_3.0.83/scripts/shBrushJScript.js"></script> 
<script type="text/javascript" src="../js/syntaxhighlighter_3.0.83/scripts/shBrushXml.js"></script> 
<link type="text/css" rel="stylesheet" href="../js/syntaxhighlighter_3.0.83/styles/shThemeFadeToGrey.css"/>  

<script type="text/javascript">
    $(function() {
        // Fancy fonts
        Cufon.replace('.titillium');
        Cufon.replace('.engraved', {
            textShadow: 'rgba(253, 224, 217, 0.45) 1.2px 1px'	
        });
        
        // Syntax highlighting
        $("pre > code").each(function() {
            var codeText = $(this).text();
            $(this).parent().text(codeText).addClass("brush:js");
        });
        SyntaxHighlighter.defaults['toolbar'] = false;
        SyntaxHighlighter.defaults['gutter'] = false;
        SyntaxHighlighter.all();
        
        // Highlight current top menu item
        var desiredMenuItem = '' || 'documentation';
        $(".main-menu a[rel=" + desiredMenuItem + "]").addClass("active");
        
        // Highlight current left-hand-nav menu item
        var urlFilename = location.href.match(/\/([^\/]+)$/);
        if (urlFilename) {
            $(".leftColContents li:has(a[href$=" + urlFilename[1] + "])").addClass("active");
        }
    });
</script> 
    </head>
    <body>
        <div id="wrapper">
            <div class="vspace"></div>
            <div class="main-menu">
    <ul>
        <li><a rel="home" href="../index.html">Home</a></li>
        <li><a rel="installation" href="../downloads/index.html">Download / Install</a></li>
        <li><a rel="tutorials" href="http://learn.knockoutjs.com/">Tutorials</a></li>
        <li><a rel="examples" href="../examples/">Live examples</a></li>
        <li><a rel="documentation" href="../documentation/introduction.html">Documentation</a></li>
        <li><a href="http://groups.google.com/group/knockoutjs">Forum</a></li>
        <li><a href="http://github.com/SteveSanderson/knockout">Source</a></li>
    </ul>
</div>        	
<div class="clear"></div>
            <div class="vspace"></div>
            <div>	
	<div class="leftCol">		
		<div class="leftColBackground">&nbsp;</div>
		<div class="leftColContents">
			<h1>Getting started</h1>

<ol>
    <li><a href="../documentation/introduction.html">How KO works and what benefits it brings</a></li>
    <li><a href="../downloads/index.html">Downloading and installing</a></li>
</ol>

<h1>Observables</h1>

<ol>
    <li><a href="../documentation/observables.html">Creating <em>view models</em> with <em>observables</em></a></li>
    <li><a href="../documentation/computedObservables.html">Using <em>computed observables</em></a></li>
    <li><a href="../documentation/observableArrays.html">Working with <em>observable arrays</em></a></li>	
</ol>

<h1>Bindings</h1>

<h2>Controlling text and appearance</h2>
<ol>
    <li><a href="../documentation/visible-binding.html">The <code>visible</code> binding</a></li>
    <li><a href="../documentation/text-binding.html">The <code>text</code> binding</a></li>
    <li><a href="../documentation/html-binding.html">The <code>html</code> binding</a></li>
    <li><a href="../documentation/css-binding.html">The <code>css</code> binding</a></li>
    <li><a href="../documentation/style-binding.html">The <code>style</code> binding</a></li>
    <li><a href="../documentation/attr-binding.html">The <code>attr</code> binding</a></li>
</ol>

<h2>Control flow</h2>
<ol>
    <li><a href="../documentation/foreach-binding.html">The <code>foreach</code> binding</a></li>
    <li><a href="../documentation/if-binding.html">The <code>if</code> binding</a></li>
    <li><a href="../documentation/ifnot-binding.html">The <code>ifnot</code> binding</a></li>
    <li><a href="../documentation/with-binding.html">The <code>with</code> binding</a></li>
</ol>

<h2>Working with form fields</h2>
<ol>
    <li><a href="../documentation/click-binding.html">The <code>click</code> binding</a></li>
    <li><a href="../documentation/event-binding.html">The <code>event</code> binding</a></li>
    <li><a href="../documentation/submit-binding.html">The <code>submit</code> binding</a></li>
    <li><a href="../documentation/enable-binding.html">The <code>enable</code> binding</a></li>
    <li><a href="../documentation/disable-binding.html">The <code>disable</code> binding</a></li>
    <li><a href="../documentation/value-binding.html">The <code>value</code> binding</a></li>
    <li><a href="../documentation/hasfocus-binding.html">The <code>hasfocus</code> binding</a></li>
    <li><a href="../documentation/checked-binding.html">The <code>checked</code> binding</a></li>
    <li><a href="../documentation/options-binding.html">The <code>options</code> binding</a></li>
    <li><a href="../documentation/selectedOptions-binding.html">The <code>selectedOptions</code> binding</a></li>    
    <li><a href="../documentation/uniqueName-binding.html">The <code>uniqueName</code> binding</a></li>		
</ol>

<h2>Rendering templates</h2>
<ol>
    <li><a href="../documentation/template-binding.html">The <code>template</code> binding</a></li>
</ol>

<h2>Binding syntax</h2>
<ol>
    <li><a href="../documentation/binding-syntax.html">The <code>data-bind</code> syntax</a></li>
    <li><a href="../documentation/binding-context.html">The binding context</a></li>
</ol>

<h1>Creating custom bindings</h1>
<ol>
    <li><a href="../documentation/custom-bindings.html">Creating custom bindings</a></li>
    <li><a href="../documentation/custom-bindings-controlling-descendant-bindings.html">Controlling descendant bindings</a></li>
    <li><a href="../documentation/custom-bindings-for-virtual-elements.html">Supporting virtual elements</a></li>
</ol>

<h1>Further techniques</h1>
<ol>
    <li><a href="../documentation/json-data.html">Loading and saving JSON data</a></li>
    <li><a href="../documentation/extenders.html">Extending observables</a></li>
    <li><a href="../documentation/throttle-extender.html">The <code>throttle</code> extender</a></li>
    <li><a href="../documentation/unobtrusive-event-handling.html">Unobtrusive event handling</a></li>
    <li><a href="../documentation/fn.html">Using <code>fn</code> to add custom functions</a></li>
</ol>

<h1>Plugins</h1>
<ol>
    <li><a href="../documentation/plugins-mapping.html">The <code>mapping</code> plugin</a></li>
</ol>

<h1>More information</h1>
<ol>
    <li><a href="../documentation/browser-support.html">Browser support</a></li>
    <li><a href="http://groups.google.com/group/knockoutjs">Getting help</a></li>
    <li><a href="../documentation/links.html">Links to tutorials &amp; examples</a></li>
    <li><a href="../documentation/amd-loading.html">Usage with AMD using RequireJs (Asynchronous Module Definition)</a></li>
</ol>

		</div>		
	</div>
	<div class="rightCol">
		<div class="documentation sticker">
		    <div class="content">
		    	<h1>Loading and Saving JSON data</h1>	
		    	<p>Knockout allows you to implement sophisticated client-side interactivity, but almost all web applications also need to exchange data with the server, or at least to serialize the data for local storage. The most convenient way to exchange or store data is in <a href='http://json.org/'>JSON format</a> - the format that the majority of Ajax applications use today.</p>

<h3 id='loading_or_saving_data'>Loading or Saving Data</h3>

<p>Knockout doesn&#8217;t force you to use any one particular technique to load or save data. You can use whatever mechanism is a convenient fit for your chosen server-side technology. The most commonly-used mechanism is jQuery&#8217;s Ajax helper methods, such as <a href='http://api.jquery.com/jQuery.getJSON/'><code>getJSON</code></a>, <a href='http://api.jquery.com/jQuery.post/'><code>post</code></a>, and <a href='http://api.jquery.com/jQuery.ajax/'><code>ajax</code></a>. You can fetch data from the server:</p>

<pre><code>$.getJSON(&quot;/some/url&quot;, function(data) { 
	// Now use this data to update your view models, 
	// and Knockout will update your UI automatically 
})</code></pre>

<p>&#8230; or you can send data to the server:</p>

<pre><code>var data = /* Your data in JSON format - see below */;
$.post(&quot;/some/url&quot;, data, function(returnedData) {
	// This callback is executed if the post was successful		
})</code></pre>

<p>Or, if you don&#8217;t want to use jQuery, you can use any other mechanism for loading or saving JSON data. So, all Knockout needs to help you do is:</p>

<ul>
<li>For saving, get your view model data into a simple JSON format so you can send it using one of the above techniques</li>

<li>For loading, update your view model using data that you&#8217;ve received using one of the above techniques</li>
</ul>

<h3 id='converting_view_model_data_to_plain_json'>Converting View Model Data to Plain JSON</h3>

<p>Your view models <em>are</em> JavaScript objects, so in a sense, you could just serialize them as JSON using any standard JSON serializer, such as <a href='https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify'>JSON.stringify</a> (a native function in modern browsers), or the <a href='https://github.com/douglascrockford/JSON-js/blob/master/json2.js'><code>json2.js</code></a> library. However, your view models probably contain observables, computed observables, and observable arrays, which are implemented as JavaScript functions and therefore won&#8217;t always serialize cleanly without additional work on your behalf.</p>

<p>To make it easy to serialize view model data, including observables and the like, Knockout includes two helper functions:</p>

<ul>
<li><code>ko.toJS</code> &#8212; this clones your view model&#8217;s object graph, substituting for each observable the current value of that observable, so you get a plain copy that contains only your data and no Knockout-related artifacts</li>

<li><code>ko.toJSON</code> &#8212; this produces a JSON string representing your view model&#8217;s data. Internally, it simply calls <code>ko.toJS</code> on your view model, and then uses the browser&#8217;s native JSON serializer on the result. Note: for this to work on older browsers that have no native JSON serializer (e.g., IE 7 or earlier), you must also reference the <a href='https://github.com/douglascrockford/JSON-js/blob/master/json2.js'><code>json2.js</code></a> library.</li>
</ul>

<p>For example, define a view model as follows:</p>

<pre><code>var viewModel = {
    firstName : ko.observable(&quot;Bert&quot;),
    lastName : ko.observable(&quot;Smith&quot;),
    pets : ko.observableArray([&quot;Cat&quot;, &quot;Dog&quot;, &quot;Fish&quot;]),
    type : &quot;Customer&quot;
};
viewModel.hasALotOfPets = ko.computed(function() {
    return this.pets().length &gt; 2
}, viewModel)</code></pre>

<p>This contains a mix of observables, computed observables, observable arrays, and plain values. You can convert it to a JSON string suitable for sending to the server using <code>ko.toJSON</code> as follows:</p>

<pre><code>var jsonData = ko.toJSON(viewModel);

// Result: jsonData is now a string equal to the following value
// &#39;{&quot;firstName&quot;:&quot;Bert&quot;,&quot;lastName&quot;:&quot;Smith&quot;,&quot;pets&quot;:[&quot;Cat&quot;,&quot;Dog&quot;,&quot;Fish&quot;],&quot;type&quot;:&quot;Customer&quot;,&quot;hasALotOfPets&quot;:true}&#39;</code></pre>

<p>Or, if you just want the plain JavaScript object graph <em>before</em> serialization, use <code>ko.toJS</code> as follows:</p>

<pre><code>var plainJs = ko.toJS(viewModel);

// Result: plainJS is now a plain JavaScript object in which nothing is observable. It&#39;s just data.
// The object is equivalent to the following:
//   {
//      firstName: &quot;Bert&quot;,
//      lastName: &quot;Smith&quot;,
//      pets: [&quot;Cat&quot;,&quot;Dog&quot;,&quot;Fish&quot;],
//      type: &quot;Customer&quot;,
//      hasALotOfPets: true
//   }</code></pre>

<p>Note that <code>ko.toJSON</code> accepts the same arguments as <a href='https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify'>JSON.stringify</a>. For example, it can be useful to have a &#8220;live&#8221; representation of your view model data when debugging a Knockout application. To generate a nicely formatted display for this purpose, you can pass the <em>spaces</em> argument into <code>ko.toJSON</code> and bind against your view model like:</p>

<pre><code>&lt;pre data-bind=&quot;text: ko.toJSON($root, null, 2)&quot;&gt;&lt;/pre&gt;</code></pre>

<h3 id='updating_view_model_data_using_json'>Updating View Model Data using JSON</h3>

<p>If you&#8217;ve loaded some data from the server and want to use it to update your view model, the most straightforward way is to do it yourself. For example,</p>

<pre><code>// Load and parse the JSON
var someJSON = /* Omitted: fetch it from the server however you want */;
var parsed = JSON.parse(someJSON);

// Update view model properties
viewModel.firstName(parsed.firstName);
viewModel.pets(parsed.pets);</code></pre>

<p>In many scenarios, this direct approach is the simplest and most flexible solution. Of course, as you update the properties on your view model, Knockout will take care of updating the visible UI to match it.</p>

<p>However, many developers prefer to use a more conventions-based approach to updating their view models using incoming data without manually writing a line of code for every property to be updated. This can be beneficial if your view models have many properties, or deeply nested data structures, because it can greatly reduce the amount of manual mapping code you need to write. For more details about this technique, see <a href='plugins-mapping.html'>the knockout.mapping plugin</a>.</p>    
		    </div>
		    
		    <div class="clear"></div>
		</div>
	</div>	
</div>
            <div class="clear"></div>
            <div class="main-menu">
    <ul>
        <li><a rel="home" href="../index.html">Home</a></li>
        <li><a rel="installation" href="../downloads/index.html">Download / Install</a></li>
        <li><a rel="tutorials" href="http://learn.knockoutjs.com/">Tutorials</a></li>
        <li><a rel="examples" href="../examples/">Live examples</a></li>
        <li><a rel="documentation" href="../documentation/introduction.html">Documentation</a></li>
        <li><a href="http://groups.google.com/group/knockoutjs">Forum</a></li>
        <li><a href="http://github.com/SteveSanderson/knockout">Source</a></li>
    </ul>
</div>        	
<div class="clear"></div>
        </div>
        
        <div id="page-footer">(c) knockoutjs.com</div> 
        
        <script type="text/javascript">               
            // Analytics
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-65756-7']);
            _gaq.push(['_trackPageview']);	
            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();             
        </script>
    </body>
</html>